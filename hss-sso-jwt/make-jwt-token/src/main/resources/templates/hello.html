<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="">
    <!--<link rel="icon" href="https://getbootstrap.com/favicon.ico">-->

    <title>Insert title here</title>

    <!-- Bootstrap core CSS -->
    <link th:href="@{/webjars/bootstrap/4.1.3/css/bootstrap.css}" rel="stylesheet">
</head>
<body>
    <h1>Thymeleaf模板文件</h1>
    Welcome <span th:text="${name}"></span>
    <div>
        <span>ajax->add:</span><button id="add">add</button><br/>
        <span>ajax->find:</span><button id="find">find</button>
    </div>
</body>
<!--jquery-->
<script type="text/javascript" th:src="@{/webjars/jquery/3.3.1/jquery.js}"></script>
<script type="text/javascript" th:src="@{/webjars/bootstrap/4.1.3/js/bootstrap.js}"></script>

<script type="text/javascript" th:src="@{/asserts/js/ajaxhook.min.js}"></script>

<script type="text/javascript">

    $(function () {

        //js获取项目的路径
        var pathName=window.document.location.pathname;
        //截取项目的名称
        var projectName=pathName.substring(0,pathName.substr(1).indexOf('/')+1);

        //alert("成功引入jquery!!!");
        hookAjax({
            //拦截回调
            onreadystatechange:function(xhr){
                console.log("onreadystatechange called: %O",xhr)
            },
            onload:function(xhr){
                console.log("onload called: %O",xhr)
            },
            //拦截函数
            open:function(arg){
                console.log("open called: method:%s,url:%s,async:%s",arg[0],arg[1],arg[2])
            },
            send:function(arg){
                console.log("send called: %O",arg[0])
            }
        });


        $("#add").click(function () {
            console.log("点击添加按钮");
            $.ajax({
                url: projectName+"/test/add",
                type: "POST",
                dataType: "json",
                success: function(data) {
                    console.log("返回结果："+data.type);
                }
            });
        });

        $("#find").click(function () {
            console.log("点击查询按钮");
            $.ajax({
                url: projectName+"/test/find",
                type: "GET",
                dataType: "json",
                success: function(data) {
                    console.log("返回结果："+data.type);
                }
            });
        });
    });
</script>
</html>